# 毕业论文代码仓库

## 1. 数据集
### 鱼类目标检测数据集
/share/Lab_Datasets/WEIZHOUYUTAI-COCO

dataset 配置文件：'./configs/_base_/datasets/weizhoudao_detection.py'

改造要点：
1. 按照 coco 格式组织数据集
2. 在 dataset 配置部分，通过 `metainfo=dict(classes=classes)` 修改数据集类别
3. 在 model 配置部分，修改所有 `bbox_head=(num_classes=?)` 中分类头的类别数

### 鱼类跟踪数据集
/share/Lab_Datasets/fish_track
包含 3 个视频， 20,000 张图像，97 条鱼。已完成 MOTChallenge 格式和 mmdet 格式改造，可以正常使用。

#### 鱼类 ReID 数据集
1. 分类形式数据集
/share/Lab_Datasets/fish_reid
从  track_datasets 中截取出来的 ReID 数据集，用于训练 reid network. 97 条鱼每条鱼为一类，9:1 划分数据集。 这是按照分类任务制作的数据集。

2. mmdet 形式数据集
如上所述。


### TrackEval 评估
TrackEval 自定义数据集及评估方法： https://github.com/JonathonLuiten/TrackEval/tree/master/docs/MOTChallenge-Official





## 2. 训练

### 1. 目标检测器

yolox_s 配置文件：./configs/yolox/yolox_s_8xb8-weizhoudao.py

yolox_s 权重：

训练指令： 
```bash
python tools/train.py ./configs/yolox/yolox_s_8xb8-weizhoudao.py
```

### 2. reid 网络
reid 网络的训练，在 mmpretrain 中进行，然后在 mmdet 中加载权重，完成跟踪。

#### GEA 数据增强

#### MPE 多路径增强

#### PMNet


## 3. 测试
### 3.1 在 fish_track 数据集上进行完整测试
配置文件：./configs/deepsort/deepsort_yolox-s_100e_fishtrack.py

测试命令：
```bash
 python tools/test_tracking.py ./configs/deepsort/deepsort_yolox-s_100e_fishtrack.py
```

### 3.2 跟踪视频可视化样例
配置文件：./configs/deepsort/deepsort_yolox-s_100e_fishtrack.py

官方教程：https://github.com/open-mmlab/mmdetection/blob/main/docs/zh_cn/user_guides/tracking_interference.md

测试命令：
```bash
python demo/mot_demo.py \
    data/fish_track/train/fish2/img1 \
    configs/deepsort/deepsort_yolox-s_100e_fishtrack.py \
    --detector \
    /home/kzy/project/PartDecoder/mmdetection/work_dirs/yolox_s_8xb8-weizhoudao/best_coco_bbox_mAP_epoch_103.pth \
    --out work_dirs/mot4.mp4 --fps 20
```

## 4. 数据可视化
### 4.1 训练过程可视化
官方教程：https://mmdetection.readthedocs.io/zh-cn/latest/user_guides/useful_tools.html#

以下是本项目简要的运行示例

### 4.2 跟踪可视化
官方教程： https://github.com/open-mmlab/mmdetection/blob/main/docs/zh_cn/user_guides/tracking_visualization.md




## 脚本文件

1. 本项目使用到的 Model 等文件，（项目中已经配置好可以运行，放在这里是为了直观的看到核心代码）
2. 一些用到的工具脚本



